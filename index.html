<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–∫–µ—Ä –ø–æ–¥–ø–∏—Å–æ–∫</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&family=VT323&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css" id="main-stylesheet">
    <link rel="stylesheet" href="pixel-art.css" id="pixel-art-stylesheet" disabled>
</head>
<body>
    <div class="app">
        <div class="header-controls">
            <div class="theme-switcher">
                <button class="theme-btn active" id="theme-nature" data-theme="nature">üåø –ü—Ä–∏—Ä–æ–¥–∞</button>
                <button class="theme-btn" id="theme-pixel" data-theme="pixel">üéÆ Pixel Art</button>
            </div>
            <div class="sync-controls">
                <span id="sync-status" class="sync-status" title="–°—Ç–∞—Ç—É—Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏">‚ö™ –õ–æ–∫–∞–ª—å–Ω–æ</span>
                <button id="btn-sync-load" class="btn-sync btn-load-cloud" style="display: none;" title="–ó–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ –æ–±–ª–∞–∫–∞">‚¨áÔ∏è –û–±–Ω–æ–≤–∏—Ç—å –∏–∑ –æ–±–ª–∞–∫–∞</button>
                <button id="btn-sync-save" class="btn-sync btn-save-cloud" style="display: none;" title="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ –æ–±–ª–∞–∫–æ">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ –æ–±–ª–∞–∫–æ</button>
                <button id="btn-sync-login" class="btn-sync" style="display: none;">–í–æ–π—Ç–∏ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</button>
                <button id="btn-sync-logout" class="btn-sync" style="display: none;">–í—ã–π—Ç–∏</button>
            </div>
        </div>

        <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—Ö–æ–¥–∞/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ -->
        <div id="auth-modal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h2 id="auth-title">–í—Ö–æ–¥ –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏</h2>
                    <button class="modal-close" id="auth-close-btn">‚úï</button>
                </div>
                <div id="auth-tabs" class="auth-tabs">
                    <button class="auth-tab active" data-tab="login">–í—Ö–æ–¥</button>
                    <button class="auth-tab" data-tab="register">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
                </div>
                <form id="auth-form">
                    <div class="form-group">
                        <label for="auth-email">Email *</label>
                        <input type="email" id="auth-email" required placeholder="your@email.com">
                    </div>
                    <div class="form-group">
                        <label for="auth-password">–ü–∞—Ä–æ–ª—å *</label>
                        <input type="password" id="auth-password" required placeholder="–ú–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤">
                    </div>
                    <div id="auth-error" class="auth-error" style="display: none;"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary" id="auth-submit-btn">–í–æ–π—Ç–∏</button>
                        <button type="button" class="btn btn-secondary" id="auth-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                </form>
            </div>
        </div>
        </div>

        <div id="statistics" class="statistics"></div>

        <div class="controls">
            <div class="filter-buttons">
                <button class="filter-btn active" data-filter="all">–í—Å–µ</button>
                <button class="filter-btn" data-filter="mine">–ú–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏</button>
                <button class="filter-btn" data-filter="others">–î–ª—è –¥—Ä—É–≥–∏—Ö</button>
            </div>
            <div class="action-buttons">
                <div class="view-mode-buttons">
                    <button class="view-mode-btn active" id="view-grid" title="–°–µ—Ç–∫–∞">
                        <span>‚äû</span>
                    </button>
                    <button class="view-mode-btn" id="view-list" title="–°–ø–∏—Å–æ–∫">
                        <span>‚ò∞</span>
                    </button>
                </div>
                <div class="action-buttons-right">
                    <button class="btn-add" id="btn-add">+ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</button>
                    <button class="btn-add" id="btn-import">+ –ò–º–ø–æ—Ä—Ç –∏–∑ –≤—ã–ø–∏—Å–∫–∏</button>
                </div>
            </div>
        </div>

        <div id="subscriptions-container" class="subscriptions-grid"></div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ñ–æ—Ä–º—ã -->
    <div id="form-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="form-title">–î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É</h2>
                <button class="modal-close" id="form-close-btn">‚úï</button>
            </div>
            <form id="subscription-form">
                <div class="form-group">
                    <label for="name">–ù–∞–∑–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏ *</label>
                    <input type="text" id="name" required placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Netflix">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="price">–°—Ç–æ–∏–º–æ—Å—Ç—å *</label>
                        <input type="number" id="price" step="0.01" min="0" required>
                    </div>
                    <div class="form-group">
                        <label for="currency">–í–∞–ª—é—Ç–∞</label>
                        <select id="currency">
                            <option value="‚ÇΩ">‚ÇΩ (–†—É–±–ª–∏)</option>
                            <option value="$">$ (–î–æ–ª–ª–∞—Ä—ã)</option>
                            <option value="‚Ç¨">‚Ç¨ (–ï–≤—Ä–æ)</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="nextBillingDate">–î–∞—Ç–∞ —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–ø–∏—Å–∞–Ω–∏—è *</label>
                    <input type="date" id="nextBillingDate" required>
                </div>
                <div class="form-group">
                    <label for="billingCycle">–ü–µ—Ä–∏–æ–¥ –æ–ø–ª–∞—Ç—ã *</label>
                    <select id="billingCycle">
                        <option value="monthly">–ï–∂–µ–º–µ—Å—è—á–Ω–æ</option>
                        <option value="yearly">–ï–∂–µ–≥–æ–¥–Ω–æ</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="group">–ì—Ä—É–ø–ø–∞ *</label>
                    <select id="group">
                        <option value="mine">–ú–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏</option>
                        <option value="others">–î–ª—è –¥—Ä—É–≥–∏—Ö</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="checkbox-label">
                        <input type="checkbox" id="excludeFromStats">
                        <span>–ù–µ —É—á–∏—Ç—ã–≤–∞—Ç—å –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–µ</span>
                    </label>
                </div>
                <div class="form-group">
                    <label for="notes">–ó–∞–º–µ—Ç–∫–∏</label>
                    <textarea id="notes" rows="3" placeholder="–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è..."></textarea>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                    <button type="button" class="btn btn-secondary" id="form-cancel-btn">–û—Ç–º–µ–Ω–∞</button>
                </div>
            </form>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –∏–º–ø–æ—Ä—Ç–∞ -->
    <div id="import-modal" class="modal" style="display: none;">
        <div class="modal-content import-modal-content">
            <div class="modal-header">
                <h2>–ò–º–ø–æ—Ä—Ç –∏–∑ –≤—ã–ø–∏—Å–∫–∏</h2>
                <button class="modal-close" id="import-close-btn">‚úï</button>
            </div>
            <p class="import-hint">
                –í—ã –º–æ–∂–µ—Ç–µ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç—ã —Å–æ —Å–ø–∏—Å–∞–Ω–∏—è–º–∏ (OCR) –∏–ª–∏ –≤—Å—Ç–∞–≤–∏—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Å–ø–∏—Å–æ–∫ –æ–ø–µ—Ä–∞—Ü–∏–π. 
                –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ø—Ä–æ–±—É–µ—Ç –Ω–∞–π—Ç–∏ –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è –ø–ª–∞—Ç–µ–∂–∏ ‚Äî –ø–æ–¥–ø–∏—Å–∫–∏.
            </p>
            <div class="import-row">
                <label class="import-file">
                    <input type="file" id="file-input" accept="image/*" multiple>
                    –í—ã–±—Ä–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è‚Ä¶
                </label>
                <button class="import-run" id="btn-ocr" disabled>–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∏ –Ω–∞–π—Ç–∏ –ø–æ–¥–ø–∏—Å–∫–∏</button>
            </div>
            <div class="import-text">
                <div class="import-text-head">
                    <div class="import-text-title">–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ —Ç–µ–∫—Å—Ç —Å–ø–∏—Å–∞–Ω–∏–π</div>
                    <button class="import-run" id="btn-parse-text" disabled>–ù–∞–π—Ç–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –∏–∑ —Ç–µ–∫—Å—Ç–∞</button>
                </div>
                <textarea id="text-input" placeholder="–ü—Ä–∏–º–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ (–ø–æ–¥–æ–π–¥–µ—Ç –∏ –ª—é–±–æ–π –ø–æ—Ö–æ–∂–∏–π):&#10;12.01.2026 Netflix 399,00 ‚ÇΩ&#10;13.01.2026 Spotify 199 ‚ÇΩ&#10;..."></textarea>
            </div>
            <div class="import-row">
                <label class="import-label">
                    –ì—Ä—É–ø–ø–∞ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
                    <select id="import-group">
                        <option value="mine">–ú–æ–∏ –ø–æ–¥–ø–∏—Å–∫–∏</option>
                        <option value="others">–î–ª—è –¥—Ä—É–≥–∏—Ö</option>
                    </select>
                </label>
                <div class="import-progress" id="import-progress"></div>
            </div>
            <div id="import-files-list" class="import-files"></div>
            <div id="import-results"></div>
            <details id="import-raw" class="import-raw" style="display: none;">
                <summary>–ü–æ–∫–∞–∑–∞—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏)</summary>
                <pre id="import-raw-text"></pre>
            </details>
        </div>
    </div>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Tesseract.js —á–µ—Ä–µ–∑ CDN -->
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5.1.1/dist/tesseract.min.js"></script>
    <!-- Firebase SDK -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js';
        import { getAuth } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js';
        import { getFirestore } from 'https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js';
        
        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Firebase (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ—é)
        // –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ: —Å–º. FIREBASE_SETUP.md
        const firebaseConfig = {
                apiKey: "AIzaSyA-nOqsByzX_2iMYg8yhNZlXOaC77Y9FQ4",
                authDomain: "lllewellla-subs-tracker.firebaseapp.com",
                projectId: "lllewellla-subs-tracker",
                storageBucket: "lllewellla-subs-tracker.firebasestorage.app",
                messagingSenderId: "647879132081",
                appId: "1:647879132081:web:20f8a0eca2b89262813390"
         };

        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Firebase (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞)
        try {
            if (firebaseConfig.apiKey && firebaseConfig.apiKey !== "YOUR_API_KEY") {
                const app = initializeApp(firebaseConfig);
                const auth = getAuth(app);
                const db = getFirestore(app);
                
                // –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
                window.firebaseApp = app;
                window.firebaseAuth = auth;
                window.firebaseDb = db;
                console.log('Firebase –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω');
            } else {
                console.log('Firebase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –†–∞–±–æ—Ç–∞–µ–º –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ.');
            }
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ Firebase:', error);
        }
    </script>
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏
        window.addEventListener('error', function(e) {
            console.error('–û—à–∏–±–∫–∞:', e.message, e.filename, e.lineno);
        });
    </script>
    <script src="firebase-sync.js"></script>
    <script src="app.js"></script>
</body>
</html>
